
## Для запуска проекта

```bash
$ npm install
```

## Для запуска проекта

```bash
# development
$ npm run start

# watch mode
$ npm run start:dev

# production mode
$ npm run start:prod
```


## Сокеты

URL подключения (пример):

ws://localhost:3000

При подключении обязательно передать JWT токен для авторизации
## События клиента

События, которые клиент отправляет на сервер:

| Событие      | Направление       | Описание                                  | Формат данных                                                                 |
|--------------|-------------------|-------------------------------------------|-------------------------------------------------------------------------------|
| `message`    | Клиент → Сервер   | Отправка сообщения                        | `{ text: string, to?: string, room?: string }`                               |
| `typing`     | Клиент → Сервер   | Статус набора текста                     | `{ isTyping: boolean }`                                                      |
| `join_room`  | Клиент → Сервер   | Смена чат-комнаты                        | `{ room: string }`                                                           |

## События сервера

События, которые сервер отправляет клиенту:

| Событие              | Направление       | Описание                                  | Пример данных                                                                 |
|----------------------|-------------------|-------------------------------------------|-------------------------------------------------------------------------------|
| `user_list`          | Сервер → Клиент   | Актуальный список пользователей в комнате | `[{ userId: "1", username: "john", typing: false }, ...]`                    |
| `room_message`       | Сервер → Клиент   | Новое сообщение в общем чате              | `{ from: "1", text: "Hello", timestamp: 1620000000, room: "general", fromUsername: "john" }` |
| `private_message`    | Сервер → Клиент   | Приватное сообщение                       | `{ from: "1", to: "2", text: "Secret", timestamp: 1620000000, delivered: true, fromUsername: "john" }` |
| `message_history`    | Сервер → Клиент   | История сообщений комнаты                 | `[{ from: "1", text: "Hi", timestamp: 1620000000, room: "general", fromUsername: "john" }, ...]` |
| `typing`             | Сервер → Клиент   | Статус набора текста пользователем        | `{ userId: "1", username: "john", isTyping: true }`                          |
| `error`              | Сервер → Клиент   | Ошибка операции                          | `{ message: "Rate limit exceeded", timestamp: 1620000000 }`                  |
| `auth_error`         | Сервер → Клиент   | Ошибка аутентификации при подключении    | `{ message: "Invalid token" }`                                              |


Ошибки
Событие: error
Возможные сообщения:

"Rate limit exceeded" - Превышена частота сообщений

"Invalid message" - Некорректное сообщение

"Unauthorized" - Ошибка авторизации

Событие: auth_error
Ошибка аутентификации при подключении

Особенности реализации
Лимиты и ограничения
Частота сообщений: Не более 10 сообщений в секунду

Длина сообщения: Максимум 2000 символов

Хранение истории:

Общие чаты: последние 1000 сообщений на комнату

Приватные сообщения: полная история

Доставка сообщений
Приватные сообщения сохраняются и доставляются при появлении получателя онлайн

Статус delivered отмечает факт получения сообщения

Статус "Печатает"
Автоматически сбрасывается через 2 секунды после последнего события

Отображается только для пользователей в текущей комнате